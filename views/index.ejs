<!DOCTYPE html>
<html lang="en">

<head>
    <!-- FAVICON (Chemin relatif au dossier public) -->
    <link rel="shortcut icon" type="image/png" href="/Data/Icon/ALStream.png?v=1">

    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="/Data/Icon/ALStream.png?v=1.1">
    <link rel="shortcut icon" type="image/png" href="/Data/Icon/ALStream.png?v=1.1">
    <title>Catalog - ALStream</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <nav class="navbar">
        <div style="display:flex; align-items:center; gap:30px;">
            <div class="logo"><a href="/">Al<span class="highlight">Stream</span></a></div>
            <a href="/catalog" class="home-button">Home</a>
        </div>
    </nav>

    <div class="layout-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-filter"></i> Filters</h3>
                <input type="text" id="tagSearchInput" placeholder="Filter tags..." onkeyup="filterTags()">
            </div>
            <div class="category-menu">
                <a href="/catalog" style="color: #888; display:block; margin-bottom:15px; font-weight:bold;">View
                    All</a>
                <% if (typeof categories !=='undefined' ) { %>
                    <% for (const [mainCat, tags] of Object.entries(categories)) { %>
                        <div class="cat-group">
                            <a href="/catalog?type=<%= mainCat %>" class="cat-title"
                                style="text-decoration: none; color: inherit; display: block; cursor: pointer;">
                                <%= mainCat %>
                                    </span>
                            </a>
                        </div>
                        <% } %>
                            <% } %>
            </div>
        </aside>

        <main class="content">
            <div class="catalog-header">
                <div class="header-spacer"></div>
                <h2 style="margin: 0; text-align: center;">Full Catalog</h2>
                <button id="toggleSearchBtn" class="search-toggle-btn" title="Search">
                    <i class="fas fa-search"></i>
                </button>
            </div>

            <div id="searchContainer" class="expandable-search-container">
                <form action="/catalog" method="GET" style="margin: 0;">
                    <input type="text" name="search" id="mainSearchInput" class="full-width-search"
                        placeholder="Search title" autocomplete="off">
                </form>
            </div>

            <div class="video-grid">
                <% if(typeof animes==='undefined' || animes.length===0) { %>
                    <p style="color: #888;">No content found.</p>
                    <% } else { %>
                        <% animes.forEach(function(anime) { %>
                            <a href="/watch/<%= anime.id %>" class="card">
                                <img src="<%= anime.affiche || 'https://via.placeholder.com/200x300?text=No+Cover' %>"
                                    alt="<%= anime.titre %>">
                                <div class="card-info">
                                    <h3>
                                        <%= anime.titre %>
                                    </h3>
                                    <div class="tags-display">
                                        <% if(anime.note) { %>
                                            <span class="tag-badge" style="background-color: #ffd700; color: black;">â˜…
                                                <%= anime.note %>
                                            </span>
                                            <% } %>
                                                <span class="tag-badge">VOSTFR</span>
                                    </div>
                                </div>
                            </a>
                            <% }); %>
                                <% } %>
            </div>
        </main>
    </div>

    <script>
        function filterTags() {
            let input = document.getElementById('tagSearchInput').value.toLowerCase();
            let tags = document.getElementsByClassName('tag-link');
            for (let i = 0; i < tags.length; i++) {
                let txt = tags[i].innerText.toLowerCase();
                tags[i].style.display = txt.includes(input) ? "block" : "none";
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            const toggleBtn = document.getElementById('toggleSearchBtn');
            const searchContainer = document.getElementById('searchContainer');
            const searchInput = document.getElementById('mainSearchInput');

            toggleBtn.addEventListener('click', function () {
                searchContainer.classList.toggle('active');
                if (searchContainer.classList.contains('active')) {
                    setTimeout(() => searchInput.focus(), 100);
                }
            });
        });
    </script>

    <!-- Footer identique au tien -->
    <footer style="background-color: #000; color: #ccc; padding: 50px 30px 30px; margin-top: 50px;">
        <!-- ... ton code de footer ... -->
    </footer>
</body>

</html>